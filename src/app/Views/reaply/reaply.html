<div class="background w-full h-dvh p-5 overflow-auto">
    <div class="flex flex-row gap-6">
        <div class="w-2/3 bg-white/90 backdrop-blur-lg p-6 rounded-2xl shadow-xl overflow-y-auto border border-gray-200">
        <header class="font-Playfair text-2xl font-bold border-b pb-3 text-gray-800">
            Applicant Information
        </header>

        <div *ngIf="!loading; else loadingBlock" class="mt-6 space-y-6">
            <section *ngIf="applicant" class="bg-gray-50 rounded-xl p-4 shadow-sm border">
                <h3 class="font-semibold text-lg text-black mb-2">Personal Information</h3>
                <p><b>Name:</b> {{ applicant.firstname | titlecase}} {{ applicant.lastname| titlecase }}</p>
                <p><b>Email:</b> {{ applicant.email| titlecase }}</p>
                <p><b>Phone:</b> {{ applicant.contactnumber| titlecase }}</p>
                <p><b>Civil Status:</b> {{ applicant.civilStatus| titlecase }}</p>
                <p><b>Birthday:</b> {{ applicant.birthdate | titlecase}}</p>
                <p><b>Religion:</b> {{ applicant.religion | titlecase}}</p>
                <p><b>Address:</b> {{ applicant.province | titlecase}}, {{ applicant.cities | titlecase}} {{ applicant.barangay | titlecase}}, {{applicant.zipcode}}</p>
                <p><b>Blood Type:</b> {{ applicant.blood_type | titlecase}}</p>
                <p><b>Gender:</b> {{ applicant.gender | titlecase}}</p>
                <p><b>Nickname:</b> {{ applicant.nickname | titlecase}}</p>
            </section>
            <section *ngIf="educationList" class="bg-gray-50 rounded-xl p-4 shadow-sm border">
                <div class="flex flex-row items-center justify-between">
                    <h3 class="font-semibold text-lg text-black mb-2">Education</h3>
                    <lucide-icon [img]="editPen" class="cursor-pointer" (click)="updateEducation(educationList.education_i_information_id!)"></lucide-icon>
                </div>
                <p><b>School:</b> {{ educationList.college }}</p>
                <p><b>Degree:</b> {{ educationList.course }}</p>
                <p><b>Year Graduated:</b> {{ educationList.yeargraduate }}</p>
            </section>
            <section *ngIf="status" class="bg-gray-50 rounded-xl p-4 shadow-sm border">
                <div class="flex flex-row items-center justify-between">
                    <h3 class="font-semibold text-lg text-black mb-2">Application Status</h3>
                    <lucide-icon [img]="editPen" class="cursor-pointer" (click)="updateStatus(status.applicant_i_status_id!)"></lucide-icon>
                </div>
                <p><b>One Year Contract:</b> {{ status.lockincontract }}</p>
                <p><b>Drivers License:</b> {{ status.license }}</p>
                <p><b>Motorcycle:</b> {{ status.motorcycle }}</p>
                <p><b>Skills:</b> {{ status.technicalSkills }}</p>
            </section>
            <section *ngIf="eligibilityList" class="bg-gray-50 rounded-xl p-4 shadow-sm border">
                <div class="flex flex-row items-center justify-between">
                    <h3 class="font-semibold text-lg text-black mb-2">Eligibility</h3>
                    <lucide-icon [img]="editPen" class="cursor-pointer" (click)="updateEligibility(eligibilityList.eligibility_i_id!)"></lucide-icon>
                </div>
                <p>{{ eligibilityList.eligibility }}</p>
            </section>
        </div>
    </div>
    <div class="bg-white/90 backdrop-blur-lg p-6 rounded-2xl shadow-xl overflow-y-auto border border-gray-200 w-1/3 gap-6 flex flex-col">
        <section *ngIf="marriage" class="bg-gray-50 rounded-xl p-4 shadow-sm border">
            <div class="flex flex-row items-center justify-between">
                <h3 class="font-semibold text-lg text-black mb-2">Marriage</h3>
                <lucide-icon [img]="editPen" class="cursor-pointer"></lucide-icon>
            </div>
            <p><b>Status:</b> {{ marriage.dateMarried }}</p>
        </section>
        <section *ngIf="work" class="bg-gray-50 rounded-xl p-4 shadow-sm border">
            <div class="flex flex-row items-center justify-between">
                <h3 class="font-semibold text-lg text-black mb-2">Work Experience</h3>
                <lucide-icon [img]="addWork" class="cursor-pointer" (click)="addWorkExperience()"></lucide-icon>
            </div>
            @for (work of work; track $index) {
                <div class="flex flex-row w-full items-center justify-between">
                    <h3 class="font-semibold text-lg text-black mb-2 block w-10 text-center rounded-full bg-primary py-1 px-3">{{$index + 1}}</h3>
                    <lucide-icon [img]="editPen" size="20px" class="cursor-pointer" (click)="modifyWork(work.work_i_information_id!)"></lucide-icon>
                </div>
                <div class="pl-5 mb-2">
                    <p><b>Company:</b> {{ work.companyname }}</p>
                    <p><b>Role:</b> {{ work.position }}</p>
                    <p><b>Reason for Leaving:</b> {{ work.reasonforleaving }}</p>
                    <p><b>Duration:</b> {{ work.workduration }}</p>
                </div> 
            }
        </section>
        <section *ngIf="status" class="bg-gray-50 rounded-xl p-4 shadow-sm border">
            <div class="flex flex-row items-center justify-between">
                <h3 class="font-semibold text-lg text-black mb-2">Portfolio</h3>
            </div>
            <p><b>Portfolio:</b> <a href="{{ status.potfolio_link }}"> {{ status.potfolio_link }}</a></p>
        </section>
    </div>
</div>

<ng-template #loadingBlock>
    <p class="text-gray-500 italic animate-pulse">Loading applicant data...</p>
</ng-template>

@if (WorkModal) {
    <div class="w-full h-dvh flex flex-col justify-center items-center bg-black/30 absolute top-0 left-0">
        <div class="w-1/3 p-3 flex flex-col bg-white rounded-xl">
            <div class="border-b-2 pb-2 flex flex-row justify-between items-center">
                <header class="text-xl">
                    Work Experience
                </header>
                <lucide-icon [img]="CircleX" class="cursor-pointer" (click)="closeWorking()"></lucide-icon>
            </div>
            <form (ngSubmit)="workingExperience()">
                <div class="mt-2">
                    <label for="" class="font-Lora text-base">Name of Company</label>
                    <input type="text" name="companyname" [(ngModel)]="WorkingInformation.companyname!" id="" class="w-full border rounded-md p-2" placeholder="Company Name">
                </div>
                <div class="mt-2">
                    <label for="" class="font-Lora text-base">How long did you work?</label>
                    <div class="flex flex-row gap-2">
                        <div class="flex flex-col w-full">
                            <label for="fromDate">From</label>
                            <input type="date" id="fromDate" [(ngModel)]="fromDate" name="fromDate" (change)="calculateDuration()" class="w-full border rounded p-1">
                        </div>
                        <div class="flex flex-col w-full">
                            <label for="toDate">To</label>
                            <input type="date" id="toDate" [(ngModel)]="toDate" name="toDate" (change)="calculateDuration()" class="w-full border rounded p-1">
                        </div>
                        </div>
                        <input type="text" name="workduration" [(ngModel)]="WorkingInformation.workduration" id="" class="w-full border rounded-md p-2 hidden" placeholder="Duration" readonly>
                    </div>
                <div class="mt-2">
                    <label for="" class="font-Lora text-base">What made you leave?</label>
                    <input type="text" name="reasonforleaving" [(ngModel)]="WorkingInformation.reasonforleaving!" id="" class="w-full border rounded-md p-2" placeholder="What made you leave?">
                </div>
                <div class="mt-2">
                    <label for="" class="font-Lora text-base">Position</label>
                    <input type="text" name="position" [(ngModel)]="WorkingInformation.position!" id="" class="w-full border rounded-md p-2" placeholder="Position">
                </div>
                <div class="mt-2">
                    <label for="" class="font-Lora text-base">What was your significant contribution in your previous company?</label>
                    <input type="text" name="contribution" [(ngModel)]="WorkingInformation.contribution" id="" class="w-full border rounded-md p-2" placeholder="Contribution">
                </div>
                <div class="mt-2">
                    <label for="" class="font-Lora text-base">How much was your previous compensation?</label>
                    <input type="text" name="previouscompensation" [(ngModel)]="WorkingInformation.previouscompensation!" id="" class="w-full border rounded-md p-2" placeholder="Position">
                </div>
                <button class="w-full p-2 rounded-xl bg-accent text-white mt-3">
                    Submit Changes
                </button>
            </form>
        </div>
    </div>
}
@if (modifyWorkExperience) {
    <div class="w-full h-dvh flex flex-col justify-center items-center bg-black/30 absolute top-0 left-0">
        <div class="w-1/3 flex flex-col p-3 bg-white rounded-xl">
            <div class="border-b-2 pb-2 flex flex-row justify-between items-center">
                <header class="text-xl">
                    Work Experience
                </header>
                <lucide-icon [img]="CircleX" class="cursor-pointer" (click)="closeWorking()"></lucide-icon>
            </div>
            <form (ngSubmit)="UpdateFormExperience()">
                <div class="mt-2">
                    <label for="" class="font-Lora text-base">Name of Company</label>
                    <input type="text" name="companyname" [(ngModel)]="WorkingInformation.companyname!" id="" class="w-full border rounded-md p-2" placeholder="Company Name">
                </div>
                <div class="mt-2">
                    <label for="" class="font-Lora text-base">How long did you work?</label>
                    <div class="flex flex-row gap-2">
                        <div class="flex flex-col w-full">
                            <label for="fromDate">From</label>
                            <input type="date" id="fromDate" [(ngModel)]="fromDate" name="fromDate" (change)="calculateDuration()" class="w-full border rounded p-1">
                        </div>
                        <div class="flex flex-col w-full">
                            <label for="toDate">To</label>
                            <input type="date" id="toDate" [(ngModel)]="toDate" name="toDate" (change)="calculateDuration()" class="w-full border rounded p-1">
                        </div>
                        </div>
                        <input type="text" name="workduration" [(ngModel)]="WorkingInformation.workduration" id="" class="w-full border rounded-md p-2 hidden" placeholder="Duration" readonly>
                    </div>
                <div class="mt-2">
                    <label for="" class="font-Lora text-base">What made you leave?</label>
                    <input type="text" name="reasonforleaving" [(ngModel)]="WorkingInformation.reasonforleaving!" id="" class="w-full border rounded-md p-2" placeholder="What made you leave?">
                </div>
                <div class="mt-2">
                    <label for="" class="font-Lora text-base">Position</label>
                    <input type="text" name="position" [(ngModel)]="WorkingInformation.position!" id="" class="w-full border rounded-md p-2" placeholder="Position">
                </div>
                <div class="mt-2">
                    <label for="" class="font-Lora text-base">What was your significant contribution in your previous company?</label>
                    <input type="text" name="contribution" [(ngModel)]="WorkingInformation.contribution" id="" class="w-full border rounded-md p-2" placeholder="Contribution">
                </div>
                <div class="mt-2">
                    <label for="" class="font-Lora text-base">How much was your previous compensation?</label>
                    <input type="text" name="previouscompensation" [(ngModel)]="WorkingInformation.previouscompensation!" id="" class="w-full border rounded-md p-2" placeholder="Position">
                </div>
                <button class="w-full p-2 rounded-xl bg-accent text-white mt-3">
                    Submit Changes
                </button>
            </form>
        </div>
    </div>
}
@if (EligibilityModal) {
    <div class="w-full h-dvh flex flex-col justify-center items-center bg-black/30 absolute top-0 left-0">
        <div class="w-1/3 flex flex-col p-3 bg-white rounded-xl">
            <div class="border-b-2 pb-2 flex flex-row justify-between items-center">
                <header class="text-xl">
                    Eligibility
                </header>
                <lucide-icon [img]="CircleX" class="cursor-pointer" (click)="closeEligibility()"></lucide-icon>
            </div>
            <div>
                <div class="flex flex-row justify-left items-center gap-2 mt-2">
                    <input type="checkbox" name="cs" [(ngModel)]="eligibilityOptions.cs" id="CS">
                    <label for="CS">CS Passer</label>
                </div>
                <div class="flex flex-row justify-left items-center gap-2 mt-2">
                    <input type="checkbox" name="let" [(ngModel)]="eligibilityOptions.let" id="LET">
                    <label for="LET">LET Passer</label>
                </div>
                <div class="flex flex-row justify-left items-center gap-2 mt-2">
                    <input type="checkbox" name="board" [(ngModel)]="eligibilityOptions.board" id="Board" value="Board Exam Passer">
                    <label for="Board">Board Exam Passer</label>
                </div>
                <div class="flex flex-row justify-left items-center gap-2 mt-2">
                    <input type="checkbox" name="none" [(ngModel)]="eligibilityOptions.none" id="None" value="None">
                    <label for="None">None</label>
                </div>
                <div class="flex flex-row justify-left items-center gap-2 mt-2">
                    <input type="checkbox" name="" id="Others" (change)="otherSelected()">
                    <label for="Others">Others</label>
                    <div class="w-full">
                        @if (OthersField) {
                            <div>
                                <input type="text" [(ngModel)]="otherEligibility" name="otherEligibility"  id="" class="w-full border-b-1 placeholder:text-gray-150" placeholder="e.g Board Exam Passer">
                            </div>
                        }
                    </div>
                </div>
                
            </div>
            <button (click)="selectEligibility()" class="w-full bg-accent text-white rounded-full mt-2 p-2">Select</button>
        </div>
    </div>
}

@if (EducationModal) {
    <div class="w-full h-dvh flex flex-col justify-center items-center bg-black/30 absolute top-0 left-0">
        <div class="w-2/4 flex flex-col p-3 bg-white rounded-xl">
            <div class="border-b-2 pb-2 flex flex-row justify-between items-center">
                <header class="text-xl">
                    Eligibility
                </header>
                <lucide-icon [img]="CircleX" class="cursor-pointer" (click)="closeEducation()"></lucide-icon>
            </div>
            <div>
                <div class="mt-2">
                    <label for="" class="text-lg font-Lora text-black">Name of College</label>
                    <input type="text" name="college" [(ngModel)]="EducationalField.college" id="" class="w-full p-2 bg-primary rounded-md outline-none" placeholder="Name of College">
                </div>
                <div class="flex flex-row gap-2">
                    <div class="w-2/3">
                        <label for="" class="text-lg font-Lora text-black">College Course Graduated</label>
                        <input type="text" name="course" [(ngModel)]="EducationalField.course" id="" class="w-full p-2 bg-primary rounded-md outline-none" placeholder="Course">
                    </div>
                    <div class="w-1/3">
                        <label for="" class="text-lg font-Lora text-black">Year Graduated College</label>
                        <input type="text" name="yeargraduate" [(ngModel)]="EducationalField.yeargraduate" id="" class="w-full p-2 bg-primary rounded-md outline-none" placeholder="ex: 2023">
                    </div>
                </div>
                <div class="mt-2">
                    <label for="" class="text-lg font-Lora text-black text-justify">When do you plan to take Graduate Course? <span class="text-base">(Please indicate year if applicable)</span></label>
                    <input type="text" name="graduateschool" id="" [(ngModel)]="EducationalField.graduateschool" class="w-full p-2 bg-primary rounded-md outline-none" placeholder="ex: 2026">
                </div>
                <div class="mt-2">
                    <label for="" class="text-lg font-Lora text-black text-justify">When do you plan to take your board exams? If no Plans, please indicate "No Plans". If already took the exam, please specify what exam was taken and the result [Passed/Failed]. (Ex: CPA Board Exam - Failed)</label>
                    <input type="text" name="boardexam" id="" [(ngModel)]="EducationalField.boardexam" class="w-full p-2 bg-primary rounded-md outline-none" placeholder="CPA Board Exam - PASSED/FAILED">
                </div>
                <button (click)="modifyEducation()" class="w-full bg-accent text-white p-2 rounded-full font-Playfair font-semibold mt-3 ">Next</button>
            </div>
        </div>
    </div>
}
@if (StatusModal) {
    <div class="w-full h-dvh flex flex-col justify-center items-center bg-black/30 absolute top-0 left-0">
        <div class="w-2/4 flex flex-col p-3 bg-white rounded-xl">
            <div class="border-b-2 pb-2 flex flex-row justify-between items-center">
                <header class="text-xl">
                    Eligibility
                </header>
                <lucide-icon [img]="CircleX" class="cursor-pointer" (click)="closeStatus()"></lucide-icon>
            </div>
            <div>
                <header class="font-Lora text-xl text-black border-b-2 pb-1">Do you have any pending application with the government or other companies that might derail your application/employment with us?</header>
                <div class="flex flex-row gap-3 mt-3">
                    <label class="flex items-center space-x-2 cursor-pointer w-full">
                        <input type="radio" name="pendingapplication" [(ngModel)]="ApplicationStatusField.pendingapplication" value="yes" class="hidden peer">
                        <span class="px-4 w-full py-2 rounded-lg text-center border-2 border-black peer-checked:bg-green-700 peer-checked:text-white peer-checked:border-none">
                            Yes
                        </span>
                    </label>

                    <label class="flex items-center space-x-2 cursor-pointer w-full">
                        <input type="radio" name="pendingapplication" [(ngModel)]="ApplicationStatusField.pendingapplication" value="no" class="hidden peer">
                        <span class="px-4 w-full py-2 rounded-lg text-center border-2 border-black peer-checked:bg-red-700 peer-checked:text-white peer-checked:border-none">
                            No
                        </span>
                    </label>
                </div>
                <header class="font-Lora text-xl mt-3 text-black border-b-2 pb-1">We have one year lock in contract for employees. Are you certain that you are willing to render minimum of 1 year of service with us regardless of opportunities that might arise in the near future?</header>
                <div class="flex flex-row gap-3 mt-3">
                    <label class="flex items-center space-x-2 cursor-pointer w-full">
                        <input type="radio" name="lockincontract" [(ngModel)]="ApplicationStatusField.lockincontract" value="yes" class="hidden peer">
                        <span class="px-4 w-full py-2 rounded-lg text-center border-2 border-black peer-checked:bg-green-700 peer-checked:text-white peer-checked:border-none">
                            Yes
                        </span>
                    </label>

                    <label class="flex items-center space-x-2 cursor-pointer w-full">
                        <input type="radio" name="lockincontract" [(ngModel)]="ApplicationStatusField.lockincontract" value="no" class="hidden peer">
                        <span class="px-4 w-full py-2 rounded-lg text-center border-2 border-black peer-checked:bg-red-700 peer-checked:text-white peer-checked:border-none">
                            No
                        </span>
                    </label>
                </div>
                <header class="font-Lora text-xl mt-3 text-black border-b-2 pb-1">Do you have motorcycle?</header>
                <div class="flex flex-row gap-3 mt-3">
                    <label class="flex items-center space-x-2 cursor-pointer w-full">
                        <input type="radio" name="motorcycle" [(ngModel)]="ApplicationStatusField.motorcycle" value="yes" class="hidden peer">
                        <span class="px-4 w-full py-2 rounded-lg text-center border-2 border-black peer-checked:bg-green-700 peer-checked:text-white peer-checked:border-none">
                            Yes
                        </span>
                    </label>

                    <label class="flex items-center space-x-2 cursor-pointer w-full">
                        <input type="radio" name="motorcycle" [(ngModel)]="ApplicationStatusField.motorcycle" value="no" class="hidden peer">
                        <span class="px-4 w-full py-2 rounded-lg text-center border-2 border-black peer-checked:bg-red-700 peer-checked:text-white peer-checked:border-none">
                            No
                        </span>
                    </label>
                </div>
                <header class="font-Lora text-xl mt-3 text-black border-b-2 pb-1">Do you have Driver's License?</header>
                <div class="flex flex-row gap-3 mt-3">
                    <label class="flex items-center space-x-2 cursor-pointer w-full">
                        <input type="radio" name="license" [(ngModel)]="ApplicationStatusField.license" value="yes" class="hidden peer">
                        <span class="px-4 w-full py-2 rounded-lg text-center border-2 border-black peer-checked:bg-green-700 peer-checked:text-white peer-checked:border-none">
                            Yes
                        </span>
                    </label>

                    <label class="flex items-center space-x-2 cursor-pointer w-full">
                        <input type="radio" name="license" [(ngModel)]="ApplicationStatusField.license" value="no" class="hidden peer">
                        <span class="px-4 w-full py-2 rounded-lg text-center border-2 border-black peer-checked:bg-red-700 peer-checked:text-white peer-checked:border-none">
                            No
                        </span>
                    </label>
                </div>
                <label for="" class="text-lg font-Lora text-white text-justify">Top 3 Technical Skills you are good at</label>
                <div class="mt-2 flex flex-row items-center justify-between gap-3">
                    <div class="w-full">
                        <input type="text" name="technicalSkills" [(ngModel)]="ApplicationStatusField.technicalSkills" [value]="getSelectedTechnicalSkills()" id="" class="w-full p-2 bg-primary rounded-md outline-none" placeholder="Technical Skills" disabled>
                    </div>
                    <lucide-icon [img]="PlusCircle" (click)="openTechnicalSkills()"></lucide-icon>
                </div>
                <div class="mt-1">
                    <label for="" class="text-lg font-Lora text-white">Applicants Question</label>
                    <textarea name="question" [(ngModel)]="ApplicationStatusField.question" id="" class="w-full p-2 bg-primary rounded-md outline-none" placeholder="Applicants Question"></textarea>
                </div> 
                <input type="file" (change)="onFileSelected($event)" class="w-full border p-3 rounded-xl mt-3">
                <span class="w-full text-center block my-2">or</span>
                <input type="text" name="potfolio_link" placeholder="Portfolio link (optional)" [(ngModel)]="ApplicationStatusField.potfolio_link" class="w-full border p-3 rounded-xl">
                <button (click)="updateStatusApplication()" class="w-full bg-accent text-white p-2 rounded-full font-Playfair font-semibold mt-3 ">Next</button>
                <div *ngIf="TechnocalSkillsVisible" class="p-5 w-full rounded-xl shadow-md bg-white absolute top-0 z-50">
                    <header class="text-2xl font-Playfair border-b-2 pb-2">Select Technical Skills</header>
                    <div class="grid grid-cols-4 gap-2 mt-2">
                        <div *ngFor="let skill of technicalOptionKeys">
                            <div>
                                <div class="flex flex-row gap-2 items-center">
                                    <input type="checkbox" [(ngModel)]="technicalOptions[skill]" [name]="skill">
                                    <label>{{ skill }}</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="technicalOptions['Other']" class="mt-2">
                        <input type="text" name="otherSkillText" [(ngModel)]="otherSkillText" placeholder="Please specify other skill" class="w-full p-2 border rounded-md">
                    </div>
                    <button (click)="selectTechnicalSkills()" class="w-full bg-accent text-white rounded-full mt-2 p-2">
                        Select
                    </button>
                </div>
            </div>
        </div>
    </div>
}